function test()
    @test get_tau(f) == 
end

Qb = algebraic_closure(QQ);

# Gram matrix
G = QQ[0 1 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1; 1 -2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 -2 0 0 0 0 0 0 0 0 1 1 1 0 1 0 1; 0 0 0 -2 0 0 0 0 0 0 1 0 1 0 1 1 1 0; 0 0 0 0 -2 0 0 0 0 0 0 0 1 1 1 0 0 1; 0 0 0 0 0 -2 0 0 0 0 1 1 0 1 0 1 0 0; 0 0 0 0 0 0 -2 0 0 0 1 0 0 1 1 0 1 1; 0 0 0 0 0 0 0 -2 0 0 1 1 1 0 0 0 1 0; 0 0 0 0 0 0 0 0 -2 0 0 1 0 0 0 0 1 1; 0 0 0 0 0 0 0 0 0 -2 0 0 0 0 1 1 0 0; 1 0 0 1 0 1 1 1 0 0 -2 2 2 2 2 0 0 2; 1 0 1 0 0 1 0 1 1 0 2 -2 1 0 2 2 1 1; 1 0 1 1 1 0 0 1 0 0 2 1 -2 0 0 1 2 1; 1 0 1 0 1 1 1 0 0 0 2 0 0 -2 1 2 2 1; 1 0 0 1 1 0 1 0 0 1 2 2 0 1 -2 1 1 1; 1 0 1 1 0 1 0 0 0 1 0 2 1 2 1 -2 2 2; 1 0 0 1 0 0 1 1 1 0 0 1 2 2 1 2 -2 1; 1 0 1 0 1 0 1 0 1 0 2 1 1 1 1 2 1 -2]

# isometry
f = QQ[3 1 0 -1 0 1 1 -1 -1 -1 1 0 -1 1 0 0 0 0; 2 1 0 -1 0 0 0 -1 0 0 0 0 -1 1 0 0 0 0; 2 1 0 -1 0 1 1 -1 0 -1 1 0 -1 1 0 0 0 0; 2 1 0 -1 0 1 1 -1 -1 0 1 0 -1 1 0 0 0 0; 3 1 0 -1 0 1 0 -1 -1 -1 1 0 -1 1 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 3 1 0 -1 0 0 1 -1 -1 -1 1 0 -1 1 0 0 0 0; 1 0 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 11 5 -3//2 -5//2 -1//2 1//2 1//2 -7//2 -3//2 -3//2 0 -1 -3 2 0 0 0 0; 6 2 0 -3 0 3 2 -2 -2 -2 2 1 -3 3 0 0 0 0; 0 -1 1//2 -1//2 1//2 3//2 3//2 -1//2 -1//2 -1//2 1 0 -1 2 0 0 0 0; 2 0 0 -1 0 2 2 -1 -1 -1 2 1 -2 2 0 0 0 0; 3 1 0 -1 0 1 2 -1 -1 -2 2 0 -1 2 0 -1 0 0; 6 2 -1 -2 0 1 2 -3 -2 -1 1 -1 -3 3 1 0 0 0; 14 7 -3//2 -5//2 -3//2 -1//2 -3//2 -3//2 -3//2 -5//2 0 0 -1 0 -1 -1 0 -1; 2 1 1 -1 0 1 1 -1 -1 -1 0 0 -1 2 -1 1 1 0]

# check that f is an isometry
@assert f*G*transpose(f)  == G

# define the lattice
B = QQ[1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1//2 1//2 1//2 1//2 1//2 1//2 1//2 1//2 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]

V = quadratic_space(QQ, G)
Vf = quadratic_space_with_isometry(V, f)
L = lattice(Vf, B)
@assert lattice(Vf,basis_matrix(L)*f) == L

